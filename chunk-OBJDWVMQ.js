import"./chunk-WFRMUFUB.js";import{a as G}from"./chunk-ILPDLS5K.js";import"./chunk-Y5THQI5Z.js";import{a as q}from"./chunk-BSPFLHYX.js";import"./chunk-EQUS2AHT.js";import{b as F,d as W,e as z,f as D,g as I,h as U,u as L}from"./chunk-TOZGBBW3.js";import{h as B,i as H}from"./chunk-B2E53Q3J.js";import{d as j}from"./chunk-ARH7HIPE.js";import{H as N,V as A}from"./chunk-KPZBUCCV.js";import{a as E}from"./chunk-QR7RS26O.js";import{b as k}from"./chunk-HCO6HHKT.js";import"./chunk-RGXTWLH4.js";import{k as T,w as V}from"./chunk-VIKG75FC.js";import{$b as R,Db as S,Eb as d,La as O,Pb as l,Qa as s,Qb as M,Vb as b,Wb as v,Xb as x,Z as m,Zb as P,_a as r,da as y,eb as C,jb as p,ma as u,na as g,pb as f,ub as n,vb as a,wb as _,zb as w}from"./chunk-COZJJN5U.js";var Z=i=>({"overlayer-boton":i});function J(i,h){if(i&1&&(n(0,"app-modal-template",0),_(1,"app-modal-respuesta",4),a()),i&2){let e=d();p("show_modal",e.is_modal_visible),s(),p("message",e.modal_respuesta)}}function K(i,h){if(i&1&&(n(0,"app-modal-template",0),_(1,"app-modal-respuesta",4),a()),i&2){let e=d();p("show_modal",e.is_modal_visible_password),s(),p("message",e.modal_respuesta)}}function Q(i,h){if(i&1){let e=w();n(0,"div",3)(1,"div",5),_(2,"img",6),n(3,"div")(4,"p",7)(5,"b"),l(6),a()(),_(7,"hr",8),n(8,"p",9),l(9),a()()(),n(10,"div",10)(11,"form",11),S("ngSubmit",function(){u(e);let o=d();return g(o.restaurar())}),n(12,"div",12)(13,"label",13),l(14,"ESCRIBE TU CONTRASE\xD1A NUEVA"),a(),n(15,"input",14),x("ngModelChange",function(o){u(e);let c=d();return v(c.password,o)||(c.password=o),g(o)}),a(),n(16,"label",13),l(17,"ESCRIBE TU CONTRASE\xD1A NUEVA UNA VEZ M\xC1S"),a(),n(18,"input",15),x("ngModelChange",function(o){u(e);let c=d();return v(c.confirm_password,o)||(c.confirm_password=o),g(o)}),a(),n(19,"button",16),l(20,"Enviar"),a()()()()()}if(i&2){let e=d();s(2),p("src",e.user().foto,O),s(4),M(e.user().nombre),s(3),M(e.user().email),s(6),b("ngModel",e.password),s(3),b("ngModel",e.confirm_password)}}function X(i,h){i&1&&(n(0,"div",25),_(1,"div",26),a())}function Y(i,h){if(i&1){let e=w();n(0,"div",17)(1,"div",18)(2,"p",19),l(3,"Para "),n(4,"b"),l(5,"restablecer tu contrase\xF1a"),a(),l(6,", escribe el correo electr\xF3nico que proporcionaste para tu registro. "),a(),n(7,"span")(8,"i"),l(9,"* Campo Obligatorio"),a()()(),_(10,"hr",20),n(11,"div",10)(12,"form",11),S("ngSubmit",function(){u(e);let o=d();return g(o.sendSolicitud())}),n(13,"div",21)(14,"input",22),x("ngModelChange",function(o){u(e);let c=d();return v(c.email,o)||(c.email=o),g(o)}),a(),n(15,"div",23)(16,"button",24),C(17,X,2,0,"div",25),l(18," Enviar "),a()()()()()()}if(i&2){let e=d();s(14),b("ngModel",e.email),s(2),p("disabled",e.enviando())("ngClass",R(4,Z,e.enviando())),s(),f(17,e.enviando()?17:-1)}}var pe=E.division,_e=(()=>{class i{constructor(){this.division=E.division,this.is_token=r(!1),this.email=r(""),this.email_valid=r(!1),this.password=r(""),this.confirm_password=r(""),this.is_modal_visible=r(!1),this.is_modal_visible_password=r(!1),this.user=r({id:0,nombre:"",email:"",pais:"",estado:"",foto:""}),this.modal_respuesta=r({title:"",message:""}),this.token=r(""),this.enviando=r(!1),this._generalService=m(j),this._activated_route=m(N),this._route=m(A),this._title=m(k),this._usuarioService=m(H),this._loginService=m(B),this._title.setTitle("Recupera tu acceso"),window.scrollTo(0,0),this._activated_route.params.subscribe(e=>{this._loginService.existLogin().subscribe(t=>{t&&this._route.navigate(["/"])}),e.token!=null&&(this.is_token.set(!0),this.token.set(e.token),this._generalService.getDataToken(this.division,e.token).subscribe(t=>{t.success?this.user.set(t.data[0]):this._route.navigate(["/restablecer-contrasena"])}))})}ngOnInit(){}sendSolicitud(){this.enviando.set(!0),this._generalService.getValidarEmail(this.email()).subscribe(e=>{e.success?this._generalService.sendCorreoRestaurarPassword(this.division,this.email()).subscribe(t=>{this.enviando.set(!1),t.success?(this.modal_respuesta().title="Restablecer Contrase\xF1a",this.modal_respuesta().message=`Revisa tu correo electr\xF3nico
            <br>
            <br>
            Hemos enviado un mensaje a <b>${this.email()}</b> Haz clic en el enlace que recibas para restablecer tu contrase\xF1a.
            <br>
            Si no ves el mensaje en tu bandeja de entrada, revisa otros lugares donde podr\xEDa estar, como tus carpetas de correo no deseado.`,this.is_modal_visible_password.set(!0)):(this.modal_respuesta().title="Error",this.modal_respuesta().message=t.msg,this.is_modal_visible.set(!0))}):(this.modal_respuesta().title="Error",this.modal_respuesta().message="El correo ingresado no es valido",this.is_modal_visible.set(!0),this.enviando.set(!1))})}restaurar(){this.confirm_password()==this.password()?this._generalService.restaurarPassword(this.token(),this.password()).subscribe(e=>{e.success?(this.modal_respuesta().title="\xA1Felicitaciones!",this.modal_respuesta().message="Has generado tu nueva contrase\xF1a exitosamente.",this.is_modal_visible.set(!0),this._loginService.login(this.user().email,this.password()).subscribe(t=>{t.success?(this._usuarioService.saveUser(t.data),this._usuarioService.setToken(t.data.token),location.replace("/")):this._route.navigate(["/login"])})):(this.modal_respuesta().title="Error",this.modal_respuesta().message="El correo ingresado no es valido",this.is_modal_visible.set(!0))}):(this.modal_respuesta().title="Error",this.modal_respuesta().message="Las contrase\xF1as no son iguales",this.is_modal_visible.set(!0))}closeModal(e){this.is_modal_visible.set(e)}closeModalPassword(e){this.is_modal_visible_password.set(e)}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=y({type:i,selectors:[["app-restablecer-contrasenia"]],standalone:!0,features:[P],decls:8,vars:3,consts:[[3,"show_modal"],[1,"cont-login","m-0-auto","bg-c-white"],[1,"p-1","mt-1","text-c-white","text-upcase","ff-sans-condensed","bg-c-site","lh-1_1","fw-700","fsz-small"],[1,"token"],[3,"message"],[1,"datos-usuario","mt-2","d-flex","justify-content-center","align-items-center","gap-1"],["alt","Foto",1,"imgPerfilRC","img-responsive",3,"src"],[1,"text-upcase","dato-nombre"],[1,"separador-linea-contenido","m-0"],[1,"dato-correo"],[1,"cont-form","m-0-auto"],[3,"ngSubmit"],[1,"form-grupo"],["for","",1,"lbl-negritas"],["type","password","name","password","placeholder","Contrase\xF1a*",1,"form-control",3,"ngModelChange","ngModel"],["type","password","name","confirm_password","placeholder","Contrase\xF1a*",1,"form-control",3,"ngModelChange","ngModel"],[1,"boton-general","bg-c-site","text-upcase","text-c-white","d-block","mt-1","ff-sans-condensed","fw-700","m-0-auto"],[1,"email"],[1,"msg-recuperar-contrasenia","mt-3","mb-3","text-center"],[1,"mb-2"],[1,"separador-linea-contenido"],[1,"form-grupo","txt-alg-rg"],["type","email","name","email","placeholder","Correo Electr\xF3nico*",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-footer--boton"],[1,"boton-general","bg-c-site","text-upcase","text-c-white","d-block","mt-1","ff-sans-condensed","fw-700","m-0-auto",3,"disabled","ngClass"],[1,"overlayer"],[1,"loader-btn"]],template:function(t,o){t&1&&(C(0,J,2,2,"app-modal-template",0)(1,K,2,2,"app-modal-template",0),n(2,"section")(3,"div",1)(4,"div",2),l(5," RESTABLECER CONTRASE\xD1A "),a(),C(6,Q,21,5,"div",3)(7,Y,19,6),a()()),t&2&&(f(0,o.is_modal_visible()?0:-1),s(),f(1,o.is_modal_visible_password()?1:-1),s(5),f(6,o.is_token()?6:7))},dependencies:[V,T,L,U,F,W,z,I,D,q,G],styles:[".cont-login[_ngcontent-%COMP%]{max-width:1140px;min-height:350px}@media (max-width: 1200px){.cont-login[_ngcontent-%COMP%]{width:85%;margin-top:3rem}}.cont-login[_ngcontent-%COMP%]   .msg-recuperar-contrasenia[_ngcontent-%COMP%]{font-size:1.3em;color:#4e4e4e}.cont-login[_ngcontent-%COMP%]   .datos-usuario[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%}.cont-login[_ngcontent-%COMP%]   .datos-usuario[_ngcontent-%COMP%]   .dato-nombre[_ngcontent-%COMP%]{font-size:20px;font-family:Open Sans Condensed,sans-serif;font-weight:900}.cont-login[_ngcontent-%COMP%]   .datos-usuario[_ngcontent-%COMP%]   .dato-correo[_ngcontent-%COMP%]{font-size:20px;font-family:Open Sans Condensed,sans-serif}.cont-login[_ngcontent-%COMP%]   .cont-form[_ngcontent-%COMP%]{padding:2.5rem;max-width:370px}.cont-login[_ngcontent-%COMP%]   .cont-form[_ngcontent-%COMP%]   .lbl-negritas[_ngcontent-%COMP%]{font-family:Open Sans Condensed,sans-serif;width:100%;text-transform:uppercase;color:#2a2a2a;font-weight:700}.cont-login[_ngcontent-%COMP%]   .cont-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:10px 0 2rem}.cont-login[_ngcontent-%COMP%]   .cont-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{max-width:max-content;padding:1rem 5rem}.overlayer-boton[_ngcontent-%COMP%]{position:relative}.overlayer-boton[_ngcontent-%COMP%]   .overlayer[_ngcontent-%COMP%]{transition:all .3s;width:100%;height:100%;position:absolute;top:0;left:0;opacity:1;background-color:#0009;z-index:2;display:flex;justify-content:center;align-items:center}.loader-btn[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:50%;display:block;margin:auto;position:relative;background:#fff;box-shadow:-24px 0 #fff,24px 0 #fff;box-sizing:border-box;animation:shadowPulse 2s linear infinite;margin:0 3rem}"]})}}return i})();export{_e as default};
