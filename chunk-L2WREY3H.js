import"./chunk-MEKLB6L5.js";import"./chunk-WKTYE2IN.js";import"./chunk-SMTHFKF7.js";import{a as ce}from"./chunk-ZV55WRZB.js";import"./chunk-OPO3KT7X.js";import"./chunk-ZV2R3LMA.js";import"./chunk-KQQ3XV4V.js";import"./chunk-NZ32AR3U.js";import"./chunk-KPWT4AZA.js";import"./chunk-HY274QHY.js";import"./chunk-PVPUIAXI.js";import"./chunk-WFRMUFUB.js";import"./chunk-ILPDLS5K.js";import"./chunk-Y5THQI5Z.js";import"./chunk-BSPFLHYX.js";import"./chunk-EQUS2AHT.js";import{b as re,d as oe,g as se,u as ae}from"./chunk-TOZGBBW3.js";import"./chunk-AUFDO7OV.js";import"./chunk-B2E53Q3J.js";import{d as ne}from"./chunk-ARH7HIPE.js";import"./chunk-KPZBUCCV.js";import{a as f}from"./chunk-QR7RS26O.js";import{b as ie}from"./chunk-HCO6HHKT.js";import{b as te}from"./chunk-RGXTWLH4.js";import{u as Z,w as ee}from"./chunk-VIKG75FC.js";import{Db as h,Eb as u,Ib as k,Kb as L,La as $,Lb as R,Mb as q,Oa as H,Pb as d,Qa as s,Qb as C,T as U,Vb as G,Wb as K,Xb as Y,Z as g,Zb as D,_a as c,ca as W,cc as J,da as I,eb as P,ec as X,fb as B,gb as z,hb as A,jb as x,k as O,ma as b,na as v,pb as V,qb as w,sa as N,sb as S,tb as F,ua as Q,ub as n,vb as a,wb as _,zb as y}from"./chunk-COZJJN5U.js";var E=f.ruta_base_api,M=(()=>{class r{constructor(){this._http=g(te)}getProductos(e){return this._http.get(`${E}productos/get_productos/${e}`)}getBannerSuper(e){return this._http.get(`${E}productos/get_banner/${e}`)}saveImpresionBannerSuper(e,t,i){let o=new FormData;return o.append("id_banner",e.toString()),o.append("division",t.toString()),o.append("id_usuario",i.toString()),this._http.post(`${E}productos/save_impresion_banner_super`,o)}getFiltraFiltrosProductos(e,t,i,o){let l=new FormData;return l.append("division",e.toString()),l.append("categoria",t),l.append("sub_categoria",i),l.append("empresa",o),this._http.post(`${E}productos/filtra_filtros_productos`,l)}getProductosFiltrados(e,t,i,o,l){let m=new FormData;return m.append("division",e.toString()),m.append("categoria",t),m.append("empresa",o),m.append("sub_categorias",i),m.append("palabra",l),this._http.post(`${E}productos/filtro_productos`,m)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=U({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function me(r,p){if(r&1){let e=y();n(0,"li",6)(1,"input",14),h("click",function(){let i=b(e).$implicit,o=u();return v(o.updateFiltros("categorias",i.id))}),a(),n(2,"label",15),d(3),a()()}if(r&2){let e=p.$implicit,t=u();s(),k("id","id_cat-",e.id,""),x("checked",t.categorias_seleccionadas().includes(e.id)?"checked":""),s(),k("for","id_cat-",e.id,""),s(),C(e.nombre)}}function he(r,p){if(r&1){let e=y();n(0,"li",6)(1,"input",17),h("click",function(){let i=b(e).$implicit,o=u(2);return v(o.updateFiltros("sub_categorias",i.id))}),a(),n(2,"label",15),d(3),a()()}if(r&2){let e=p.$implicit,t=u(2);s(),k("id","ce-",e.id,""),x("checked",t.sub_categorias_seleccionadas().includes(e.id)?"checked":""),s(),k("for","ce-",e.id,""),s(),C(e.nombre)}}function fe(r,p){if(r&1&&(n(0,"label",16),d(1),a(),S(2,he,4,6,"li",6,w)),r&2){let e=p.$implicit;s(),C(e.nombre_categoria),s(),F(e.sub_categorias)}}function ge(r,p){if(r&1){let e=y();n(0,"li",6)(1,"input",18),h("click",function(){let i=b(e).$implicit,o=u();return v(o.updateFiltros("empresas",i.id))}),a(),n(2,"label",15),d(3),a()()}if(r&2){let e=p.$implicit,t=u();s(),k("id","ca-",e.id,""),x("checked",t.empresas_seleccionadas().includes(e.id)?"checked":""),s(),k("for","ca-",e.id,""),s(),C(e.nombre)}}var pe=f.division,de=(()=>{class r{constructor(){this._productosService=g(M),this.onFiltros=new Q,this.numero_resultados=N(0),this.mapaPlural={"=0":"0 resultados encontrados.","=1":"1 resultado encontrado.",other:"# resultados encontrados."},this.arr_categorias=c([]),this.arr_sub_categorias=c([]),this.arr_empresas=c([]),this.categorias_seleccionadas=c([]),this.sub_categorias_seleccionadas=c([]),this.empresas_seleccionadas=c([]),this.palabra_buscada=c(""),this.searchSubject=new O,this._productosService.getFiltraFiltrosProductos(pe,"0","0","0").subscribe(e=>{e.success&&(this.arr_categorias.set(e.data.categorias),this.arr_empresas.set(e.data.empresas),this.arr_sub_categorias.set(e.data.SubCategorias))})}onKeyUp(e){let t=e.target.value;this.searchSubject.next(t)}updateFiltros(e,t){switch(e){case"categorias":this.categorias_seleccionadas().includes(t)?this.categorias_seleccionadas().splice(this.categorias_seleccionadas().indexOf(t),1):this.categorias_seleccionadas().push(t);break;case"empresas":this.empresas_seleccionadas().includes(t)?this.empresas_seleccionadas().splice(this.empresas_seleccionadas().indexOf(t),1):this.empresas_seleccionadas().push(t);break;case"sub_categorias":this.sub_categorias_seleccionadas().includes(t)?this.sub_categorias_seleccionadas().splice(this.sub_categorias_seleccionadas().indexOf(t),1):this.sub_categorias_seleccionadas().push(t);break;default:break}this._productosService.getFiltraFiltrosProductos(pe,this.categorias_seleccionadas().join(),this.sub_categorias_seleccionadas().join(),this.empresas_seleccionadas().join()).subscribe(i=>{i.success&&(this.arr_categorias.set(i.data.categorias),this.arr_empresas.set(i.data.empresas),this.arr_sub_categorias.set(i.data.SubCategorias))}),this.onFiltros.emit({categorias_seleccinadas:this.categorias_seleccionadas(),empresas_seleccinadas:this.empresas_seleccionadas(),sub_categorias_seleccionadas:this.sub_categorias_seleccionadas(),palabra_buscada:this.palabra_buscada()})}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=I({type:r,selectors:[["app-filtro"]],inputs:{numero_resultados:[W.SignalBased,"numero_resultados"]},outputs:{onFiltros:"onFiltros"},standalone:!0,features:[D],decls:33,vars:5,consts:[[1,"cont-filtro-principal","pt-1","pb-1","mb-1"],[1,"filtro-general","d-flex","flex-wrap","w-100"],[1,"filtro-col","w-100","p-0","mt-1"],[1,"titulo-filtro","ff-sans-condensed","text-c-dark-gray","pr-2","pl-2"],[1,"separador-filtro","mt-1_5","mb-1_5","ml-2","mr-2","bg-c-site"],[1,"lista-elementos-filtro","pl-2","pr-2"],[2,"display","block"],[1,"filtro-buscador","d-flex","gap-1","flex-wrap","w-100","mt-2","mb-1","pr-2","pl-2"],[1,"filtro-form","flex-grow-3"],[1,"filtro-form-grupo","d-flex","align-items-center"],["type","text","name","palabra_buscada",1,"bor-rad-15","w-100","pl-1_5","pr-1_5",3,"ngModelChange","keyup","ngModel"],["type","submit",1,"icon-pec-lupa","bor-rad-15","pos-relative","bg-c-gray"],[1,"filtro-num-result","d-flex","align-items-center","flex-grow-1"],["id","num-res-filtro pos-relative pl-1_5   fw-lighter"],["type","checkbox",1,"check_categoria",3,"click","checked","id"],[1,"fw-bold","pos-relative",3,"for"],[1,"titulo-categoria","text-c-site","fw-bold","mb-0_5","d-block"],["type","checkbox",1,"check_empresa",3,"click","checked","id"],["type","checkbox",1,"check_autor",3,"click","checked","id"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),d(4,"Categor\xEDas"),a(),_(5,"hr",4),n(6,"ul",5),S(7,me,4,6,"li",6,w),a()(),n(9,"div",2)(10,"h4",3),d(11,"Subcategor\xEDas"),a(),_(12,"hr",4),n(13,"ul",5),S(14,fe,4,1,null,null,w),a()(),n(16,"div",2)(17,"h4",3),d(18,"Empresas"),a(),_(19,"hr",4),n(20,"ul",5),S(21,ge,4,6,"li",6,w),a()()(),n(23,"div",7)(24,"div",8)(25,"div",9)(26,"input",10),Y("ngModelChange",function(l){return K(i.palabra_buscada,l)||(i.palabra_buscada=l),l}),h("keyup",function(){return i.updateFiltros("",0)}),a(),_(27,"button",11),a()(),n(28,"div",12)(29,"i")(30,"span",13),d(31),J(32,"i18nPlural"),a()()()()()),t&2&&(s(7),F(i.arr_categorias()),s(7),F(i.arr_sub_categorias()),s(7),F(i.arr_empresas()),s(5),G("ngModel",i.palabra_buscada),s(5),C(X(32,2,i.numero_resultados(),i.mapaPlural)))},dependencies:[ee,Z,ae,re,oe,se]})}}return r})();var be=["cont_productos"],ve=()=>[import("./chunk-IBTT35K3.js").then(r=>r.CartaProductoComponent)];function xe(r,p){if(r&1&&(n(0,"section")(1,"div",8)(2,"a",9),_(3,"img",10),a()()()),r&2){let e=u();s(2),x("href",e.banner_super().link,$),s(),x("src",e.banner_super().imagen,$)}}function Ce(r,p){if(r&1&&(n(0,"h2",4),d(1),a()),r&2){let e=u();s(),C(e.description())}}function we(r,p){if(r&1){let e=y();n(0,"app-filtro",11),h("onFiltros",function(i){b(e);let o=u();return v(o.FiltrosUpdate(i))}),a()}}function Se(r,p){if(r&1&&_(0,"app-carta-producto",12),r&2){let e=u().$implicit;x("producto_de_productos",e)("tipo","producto")}}function Fe(r,p){r&1&&_(0,"div",13)}function ye(r,p){r&1&&(P(0,Se,1,2)(1,Fe,1,0),B(2,0,ve,null,1),A(0,-1))}function ke(r,p){r&1&&_(0,"app-msg-sin-contenido")}var T=f.division,Xe=(()=>{class r{constructor(){this._titleService=g(ie),this._generalService=g(ne),this._productosService=g(M),this.description=c(""),this.banner_super=c(void 0),this.arr_productos=c([]),this.arr_productos_visibles=c([]),this.indice=c(0),this.limite=c(20),this.cargando=c(!1),this.show_filtro=c(!1),this.categorias=c(""),this.sub_categorias=c(""),this.empresas=c(""),this.palabra_buscada=c(""),this.scroll=e=>{if(!this.cargando()){let t=window.scrollY,i=this.cont_productos.nativeElement.offsetHeight,o=this.cont_productos.nativeElement.offsetTop,l=window.innerHeight,m=t+l,ue=i+o-100;if(m>ue){this.cargando.set(!0);let _e=this.arr_productos().slice(this.indice(),this.indice()+this.limite());this.arr_productos_visibles.update(j=>[...j,..._e]),this.indice.update(j=>j+=this.limite()),setTimeout(()=>{this.cargando.set(!1)},500)}}},window.scrollTo(0,0),this._titleService.setTitle("Productos de "+f.nombre_division),this._generalService.getMetas("productos","producto",T).subscribe({next:({statusCode:e,data:t})=>{this.description.set(t.description)},error:e=>this.description.set("")}),this._productosService.getBannerSuper(T).subscribe(e=>{if(e.success&&e.data.length!=0&&(this.banner_super.set(e.data[0]),f.production&&!f.isSandbox)){let t=this._generalService.getUser();this._productosService.saveImpresionBannerSuper(this.banner_super().id,T,t.id)}}),this._productosService.getProductos(T).subscribe(e=>{e.success&&(this.arr_productos.set(e.data),this.arr_productos_visibles.set(this.arr_productos().slice(this.indice(),this.indice()+this.limite())),this.indice.update(t=>t+=this.limite()),this.cargando.set(!0),setTimeout(()=>{this.cargando.set(!1)},1e3))})}toggelFiltro(){this.show_filtro.update(e=>!e)}FiltrosUpdate(e){e.empresas_seleccinadas.length!=0||e.categorias_seleccinadas.length!=0||e.sub_categorias_seleccionadas.length!=0||e.palabra_buscada.trim()!=""?(this.categorias.set(e.categorias_seleccinadas.join()),this.sub_categorias.set(e.sub_categorias_seleccionadas.join()),this.empresas.set(e.empresas_seleccinadas.join()),this.palabra_buscada.set(e.palabra_buscada),this.arr_productos_visibles.set([]),this.arr_productos.set([]),this.cargando.set(!0),this._productosService.getProductosFiltrados(T,this.categorias(),this.sub_categorias(),this.empresas(),this.palabra_buscada()).subscribe(t=>{t.success&&(this.cargando.set(!1),this.arr_productos.update(i=>[...i,...t.data.resultados]),this.arr_productos_visibles.set(this.arr_productos().slice(0,10)),this.indice.set(10))})):(this.arr_productos_visibles.set([]),this.arr_productos.set([]),this.cargando.set(!0),this._productosService.getProductos(T).subscribe(t=>{t.success&&(this.cargando.set(!1),this.arr_productos.update(i=>[...i,...t.data]),this.arr_productos_visibles.set(this.arr_productos().slice(0,10)),this.indice.update(i=>i+this.limite()))}))}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=I({type:r,selectors:[["app-productos"]],viewQuery:function(t,i){if(t&1&&L(be,5),t&2){let o;R(o=q())&&(i.cont_productos=o.first)}},standalone:!0,features:[D],decls:18,vars:4,consts:[["cont_productos",""],[1,"cont-productos","m-0-auto","mt-2","mb-2",3,"scroll"],[1,"bg-c-site","d-flex","gap-1","justify-content-space-between","align-items-center","mb-1","p-1","pl-2","pr-2"],[1,"cont__title__section","text-upcase","text-c-white","ff-sans-condensed","lh-1_1","mb-0_5"],[1,"descripcion-pagina","text-c-white","fw-400"],[1,"cont-boton-filtro","text-c-white","text-upcase","cursor-pointer",3,"click"],[1,"icon-pec-filtro"],[1,"cont-lista-productos","d-grid","gap-1"],[1,"banner-super"],[3,"href"],["alt","banner-super",3,"src"],[3,"onFiltros"],[3,"producto_de_productos","tipo"],[2,"height","250px","width","100%"]],template:function(t,i){if(t&1){let o=y();P(0,xe,4,2),B(1,0),n(3,"div",1),h("scroll",function(m){return b(o),v(i.scroll(m))},!1,H),n(4,"div",2)(5,"div")(6,"h1",3),d(7,"Productos"),a(),P(8,Ce,2,1,"h2",4),a(),n(9,"div",5),h("click",function(){return b(o),v(i.toggelFiltro())}),d(10," Filtrar "),_(11,"span",6),a()(),P(12,we,1,0,"app-filtro"),n(13,"div",7,0),S(15,ye,4,0,null,null,w),a(),P(17,ke,1,0,"app-msg-sin-contenido"),a()}t&2&&(s(),z(i.banner_super()!=null),s(7),V(8,i.description().trim().length!=0?8:-1),s(4),V(12,i.show_filtro()?12:-1),s(3),F(i.arr_productos_visibles()),s(2),V(17,i.arr_productos_visibles().length==i.arr_productos().length?17:-1))},dependencies:[de,ce],styles:[".cont-productos[_ngcontent-%COMP%]   .cont-lista-productos[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}@media (max-width: 639px){.cont-productos[_ngcontent-%COMP%]   .cont-lista-productos[_ngcontent-%COMP%]{padding:0 2rem}}@media (min-width: 1200px){.cont-productos[_ngcontent-%COMP%]{max-width:1140px}}"]})}}return r})();export{Xe as default};
